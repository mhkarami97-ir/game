# بازی مار - Snake Game

یک بازی کلاسیک مار با رابط کاربری مدرن و قابلیت‌های پیشرفته که با استفاده از HTML، CSS و JavaScript خالص ساخته شده است.

## ویژگی‌ها

### قابلیت‌های اصلی
- **بازی کلاسیک مار**: حرکت مار و خوردن غذا برای بزرگ شدن
- **سیستم امتیازدهی**: امتیاز با ضریب سطح و ذخیره بهترین امتیاز
- **سیستم سطح‌بندی**: افزایش سطح هر ۵ غذا با افزایش سرعت
- **چند سطح سختی**: آسان، متوسط، سخت و حرفه‌ای
- **اندازه‌های مختلف شبکه**: کوچک (15×15)، عادی (20×20) و بزرگ (25×25)

### قابلیت‌های پیشرفته
- **دو زبانه کامل**: پشتیبانی از فارسی (RTL) و انگلیسی (LTR)
- **حالت تاریک/روشن**: تغییر تم با انیمیشن‌های نرم
- **ذخیره‌سازی پایدار**: 
  - تنظیمات در localStorage
  - آمار و تاریخچه بازی‌ها در IndexedDB
- **آمار جامع**: 
  - تعداد کل بازی‌ها
  - مجموع و میانگین امتیاز
  - طولانی‌ترین مار
  - زمان کل بازی
  - جدول امتیازات ۱۰ بازی برتر
- **افکت‌های صوتی**: صداهای سینتی‌سایزر برای خوردن غذا و پایان بازی
- **طراحی ریسپانسیو**: بهینه برای تمام اندازه‌های صفحه (دسکتاپ، تبلت، موبایل)
- **کنترل‌های چندگانه**: فلش‌ها، WASD، Space و R

### تجربه کاربری
- **انیمیشن‌های نرم**: تمام تغییرات با ترنزیشن
- **بازخورد بصری**: هاور افکت‌ها و تغییرات رنگ
- **چشم‌های متحرک**: مار با چشم‌هایی که جهت حرکت را نشان می‌دهند
- **حالت توقف**: امکان توقف و ادامه بازی در هر لحظه
- **مودال آمار**: نمایش جزئیات کامل عملکرد

## ساختار پروژه

```
snake/
├── index.html           # ساختار HTML
├── style.css            # استایل‌های CSS با متغیرهای تم
├── script.js            # منطق بازی با معماری OOP
├── translations.json    # فایل ترجمه‌های دو زبانه
└── README.md           # مستندات (این فایل)
```

## نحوه استفاده

### راه‌اندازی ساده
1. فایل `index.html` را در مرورگر باز کنید
2. روی دکمه "شروع بازی" کلیک کنید
3. از فلش‌ها یا کلیدهای WASD برای کنترل استفاده کنید

### کنترل‌ها

| کلید | عملکرد |
|------|--------|
| `↑` `↓` `←` `→` | حرکت مار |
| `W` `A` `S` `D` | حرکت مار (جایگزین) |
| `Space` | توقف/ادامه بازی |
| `R` | شروع مجدد بازی |

### تنظیمات قابل تغییر

#### سختی بازی
- **آسان**: سرعت کم، شبکه 15×15
- **متوسط**: سرعت متوسط، شبکه 20×20 (پیش‌فرض)
- **سخت**: سرعت زیاد، شبکه 25×25
- **حرفه‌ای**: سرعت خیلی زیاد، شبکه 30×30

#### اندازه شبکه
- **کوچک**: 15×15 سلول
- **عادی**: 20×20 سلول (پیش‌فرض)
- **بزرگ**: 25×25 سلول

#### صدا
- **افکت صوتی**: صداهای بازی (پیش‌فرض: فعال)
- **موسیقی**: موسیقی پس‌زمینه (پیش‌فرض: غیرفعال)

## معماری کد

### الگوهای طراحی
- **Module Pattern**: کپسوله‌سازی کامل کد در IIFE
- **Revealing Module Pattern**: افشای تنها API عمومی (init)
- **Separation of Concerns**: جداسازی منطق، نمایش و داده

### ساختار کد
```javascript
var SnakeGame = (function() {
    // Configuration object
    var config = { ... };
    
    // Game state
    var gameState = { ... };
    
    // Statistics
    var stats = { ... };
    
    // Private functions
    function initGame() { ... }
    function update() { ... }
    function draw() { ... }
    
    // Public API
    return {
        init: init
    };
})();
```

### مدیریت حالت
- **config**: تنظیمات ثابت بازی (canvas، gridSize، ترجمه‌ها)
- **gameState**: حالت فعلی بازی (مار، غذا، امتیاز، جهت)
- **stats**: آمار کلی بازی (کل بازی‌ها، امتیاز، رکوردها)

### ذخیره‌سازی داده

#### localStorage
```javascript
- snakeGameLanguage: زبان انتخابی ('fa' یا 'en')
- snakeGameTheme: تم انتخابی ('light' یا 'dark')
- snakeHighScore: بهترین امتیاز
```

#### IndexedDB
```javascript
Database: SnakeGameDB
├── ObjectStore: stats
│   └── globalStats: { totalGames, totalScore, longestSnake, totalPlayTime }
└── ObjectStore: games
    └── game records: { score, level, snakeLength, foodEaten, playTime, difficulty, date }
```

## ویژگی‌های فنی

### CSS Variables برای تم‌سازی
```css
:root {
    --primary-color: #4CAF50;
    --text-color: #333;
    --bg-color: #f5f5f5;
    /* ... */
}

[data-theme="dark"] {
    --primary-color: #66BB6A;
    --text-color: #e0e0e0;
    --bg-color: #1a1a1a;
    /* ... */
}
```

### Canvas Rendering
- رندر با استفاده از Canvas 2D Context
- شبکه با خطوط راهنما
- مار با سر متمایز و چشم‌های متحرک
- غذا به صورت دایره با برگ سبز

### Responsive Design
- Grid Layout برای چینش اصلی
- Flexbox برای کامپوننت‌های داخلی
- Media Queries برای ۴ سایز صفحه:
  - Desktop: بالای 1024px
  - Tablet: 768px-1024px
  - Mobile Large: 480px-768px
  - Mobile Small: زیر 480px

### بهینه‌سازی عملکرد
- استفاده از `setTimeout` به جای `setInterval` برای کنترل بهتر
- محاسبه تنها یک بار در هر فریم
- ذخیره‌سازی مقادیر محاسبه شده در متغیرها
- استفاده از Event Delegation در جاهای مناسب

### دسترسی‌پذیری
- استفاده از HTML Semantic
- برچسب‌های مناسب برای عناصر فرم
- پشتیبانی از `prefers-reduced-motion`
- کنترست رنگی مناسب در هر دو تم
- قابلیت کنترل کامل با کیبورد

## پشتیبانی مرورگر

| مرورگر | نسخه حداقل |
|--------|------------|
| Chrome | 90+ |
| Firefox | 88+ |
| Safari | 14+ |
| Edge | 90+ |
| Opera | 76+ |

### ویژگی‌های مورد نیاز
- ES6 Support
- Canvas API
- IndexedDB
- LocalStorage
- CSS Custom Properties
- CSS Grid & Flexbox
- Web Audio API (اختیاری)

## توسعه و سفارشی‌سازی

### افزودن زبان جدید
در فایل `translations.json`:
```json
{
  "fa": { ... },
  "en": { ... },
  "newLang": {
    "title": "Game Title",
    "startGame": "Start",
    ...
  }
}
```

### تغییر رنگ‌ها
در فایل `style.css` متغیرهای CSS را ویرایش کنید:
```css
:root {
    --primary-color: #your-color;
    --snake-color: #your-color;
    --food-color: #your-color;
}
```

### افزودن سطح سختی جدید
در فایل `script.js`:
```javascript
var difficultySettings = {
    easy: { speed: 200, gridSize: 15 },
    custom: { speed: 120, gridSize: 22 }
};
```

### تغییر امتیازدهی
در تابع `eatFood()`:
```javascript
gameState.score += 10 * gameState.level; // فرمول امتیاز
```

## مشکلات شناخته شده و محدودیت‌ها

### محدودیت‌ها
- نمی‌توان جهت حرکت را معکوس کرد (بخشی از قوانین بازی)
- حداکثر 10 رکورد در جدول امتیازات نمایش داده می‌شود
- موسیقی پس‌زمینه پیاده‌سازی نشده (فقط افکت‌های صوتی)

### نکات مهم
- در Safari ممکن است Web Audio API نیاز به تعامل کاربر داشته باشد
- IndexedDB در حالت Private Browsing محدودیت دارد
- Canvas ممکن است در صفحات خیلی کوچک کیفیت پایین‌تری داشته باشد

## نکات بازی

### استراتژی‌های پیشرفته
1. **حرکت مارپیچی**: در مرکز صفحه حرکت کنید تا فضا تمام نشود
2. **دنبال کردن دم**: دم خود را دنبال کنید تا از گیر افتادن جلوگیری شود
3. **گوشه‌ها را رزرو کنید**: برای مانورهای اضطراری
4. **سرعت کنترل شده**: در سطوح بالا آهسته‌تر تصمیم بگیرید

### رکوردشکنی
- در سطح آسان شروع کنید و مهارت بسازید
- افکت صوتی را فعال کنید برای بازخورد فوری
- از WASD استفاده کنید برای حرکت سریع‌تر
- تمرکز روی زنده ماندن، نه امتیاز بالا

## مشارکت

این پروژه با تمرکز بر کد تمیز، عملکرد بالا و تجربه کاربری عالی توسعه یافته است. 

### اصول توسعه
- استفاده از `var` برای تعریف متغیرها
- کامنت تنها در صورت ضرورت
- اصول OOP و الگوهای طراحی
- کد خودتوضیح و خوانا
- تست در چند مرورگر

## مجوز

این پروژه آزادانه قابل استفاده، تغییر و توزیع است.

## تشکر

از تمام توسعه‌دهندگانی که با ایده‌ها و بازخوردهای خود به بهبود این بازی کمک کرده‌اند، تشکر می‌کنیم.

---

**نسخه**: 1.0.0  
**تاریخ آخرین به‌روزرسانی**: فوریه 2026  
**زبان‌های پشتیبانی شده**: فارسی، انگلیسی
